---
title: "ETC513 Assignment 3: Comparison of Energy and Pollution by Country"
author:
- familyname: Chen
  othernames: Shaohu
  address: Monash Universtidy
  email: sche0232@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics(In Progress)
- familyname: Duan
  othernames: Qian
  address: Monash Universtidy
  email: qdua0005@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics(In Progress)
- familyname: Tsou
  othernames: Tina
  address: Monash Universtidy
  email: ttso0004@student.monash.edu
  correspondingauthor: true
  qualifications:  Master of Business Analytics(In Progress)
department: Our consultancy \newline add names &\newline add names
organization: Australian Government 
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  bookdown::pdf_document2:
    template: monashreport2.tex
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
editor_options: 
  chunk_output_type: console
---

```{r ,echo = FALSE, message = FALSE, warning = FALSE}
# Libraries
library(tidyverse)
library(readr)
library(kableExtra)
library(bookdown)
drive <- read_csv(here::here("Data/practicaldrivingexaminationresults.csv"))
```

\section*{Introduction}




\section*{Step 1}




\section*{Step 2}
```{r}
library(plotly)
```

```{r}
# select the age group
age <- drive %>%
  select(`Product Type Name`, `Driver Age Group`, `Exam Result`, `Number of Examinations`) %>%
  mutate(Age_group1 = str_remove(`Driver Age Group`, "Aged"),
         Age_group2 = str_remove(Age_group1, "years")) %>%
  rename(age_group = Age_group2) %>%
# count the pass rate by different product type
  group_by(`Product Type Name`, age_group, `Exam Result`) %>%
  count()
```

```{r}
# plot the age group by license
ggplot(age)+
  geom_bar(aes(y = age_group,
               x = n,
               fill = `Exam Result`),
           stat = "identity",
           position = "fill")+
  geom_vline(xintercept = 0.5, color = "yellow")+
  facet_wrap(~`Product Type Name`, nrow = 4,
             scale = "free_y")

  
```
This graph illustrates all the driver license pass rate according to different age group. Most pass rate is higher than fail rate, except the manual car in older age. This is because it's too hard to pass in 80 years old. Same as automatic car with higher fall rate when the age above 45 years old.


```{r}
# count the pass rate 
pass_rate <- drive %>%
  select(`Product Type Name`, `Driver Age Group`, `Exam Result`, `Number of Examinations`) %>%
  filter(`Exam Result` == "PASS") %>%
# There are 211,717 people recorded pass
  pivot_wider(names_from = `Driver Age Group`,
              values_from = `Number of Examinations`)
  
```


\section*{Step 3}

